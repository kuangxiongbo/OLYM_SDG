<!DOCTYPE html>
<html>
<head>
    <title>é…ç½®ä¿å­˜éªŒè¯</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; }
        .card { background: white; padding: 20px; margin: 20px 0; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .form-group { margin: 15px 0; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }
        button { background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin: 5px; }
        button:hover { background: #0056b3; }
        .success { background: #d4edda; color: #155724; padding: 10px; border-radius: 4px; margin: 10px 0; }
        .error { background: #f8d7da; color: #721c24; padding: 10px; border-radius: 4px; margin: 10px 0; }
        .info { background: #d1ecf1; color: #0c5460; padding: 10px; border-radius: 4px; margin: 10px 0; }
        .config-display { background: #f8f9fa; padding: 15px; border-radius: 4px; margin: 10px 0; font-family: monospace; white-space: pre-wrap; border: 1px solid #dee2e6; }
        .test-section { border-left: 4px solid #007bff; padding-left: 15px; margin: 20px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ DeepSeekæœ¬åœ°æ¨¡å‹é…ç½®ä¿å­˜éªŒè¯</h1>
        
        <div class="card">
            <h2>ğŸ“ é…ç½®è¾“å…¥</h2>
            <div class="form-group">
                <label for="local-url">æœ¬åœ°APIåœ°å€:</label>
                <input type="text" id="local-url" value="http://192.168.210.209:11434/api/generate" placeholder="è¾“å…¥æœ¬åœ°APIåœ°å€">
            </div>
            <div class="form-group">
                <label for="local-model">æ¨¡å‹åç§°:</label>
                <input type="text" id="local-model" value="deepseek-r1" placeholder="è¾“å…¥æ¨¡å‹åç§°">
            </div>
            <div class="form-group">
                <label for="local-timeout">è¶…æ—¶æ—¶é—´(ç§’):</label>
                <input type="number" id="local-timeout" value="30" min="5" max="300">
            </div>
            <button onclick="saveConfig()">ğŸ’¾ ä¿å­˜é…ç½®</button>
            <button onclick="loadConfig()">ğŸ“‚ åŠ è½½é…ç½®</button>
            <button onclick="clearConfig()">ğŸ—‘ï¸ æ¸…é™¤é…ç½®</button>
            <button onclick="runFullTest()">ğŸ§ª è¿è¡Œå®Œæ•´æµ‹è¯•</button>
        </div>
        
        <div class="card">
            <h2>ğŸ“Š å½“å‰é…ç½®çŠ¶æ€</h2>
            <div id="config-display" class="config-display">æš‚æ— é…ç½®æ•°æ®</div>
        </div>
        
        <div class="card">
            <h2>ğŸ§ª æµ‹è¯•ç»“æœ</h2>
            <div id="test-results"></div>
        </div>
        
        <div class="card">
            <h2>ğŸ“‹ æµ‹è¯•æ­¥éª¤è¯´æ˜</h2>
            <div class="test-section">
                <h3>æ­¥éª¤1: ä¿å­˜é…ç½®</h3>
                <p>ç‚¹å‡»"ä¿å­˜é…ç½®"æŒ‰é’®ï¼Œå°†å½“å‰è¾“å…¥çš„é…ç½®ä¿å­˜åˆ°localStorageä¸­ã€‚</p>
            </div>
            <div class="test-section">
                <h3>æ­¥éª¤2: åŠ è½½é…ç½®</h3>
                <p>ç‚¹å‡»"åŠ è½½é…ç½®"æŒ‰é’®ï¼Œä»localStorageä¸­è¯»å–ä¹‹å‰ä¿å­˜çš„é…ç½®å¹¶å¡«å……åˆ°è¡¨å•ä¸­ã€‚</p>
            </div>
            <div class="test-section">
                <h3>æ­¥éª¤3: éªŒè¯æŒä¹…åŒ–</h3>
                <p>åˆ·æ–°é¡µé¢åï¼Œé…ç½®åº”è¯¥è‡ªåŠ¨åŠ è½½å¹¶æ˜¾ç¤ºåœ¨è¡¨å•ä¸­ã€‚</p>
            </div>
        </div>
    </div>

    <script>
        // ä¿å­˜é…ç½®å‡½æ•°
        function saveConfig() {
            const config = {
                url: document.getElementById('local-url').value,
                model: document.getElementById('local-model').value,
                timeout: document.getElementById('local-timeout').value,
                timestamp: new Date().toISOString()
            };
            
            try {
                localStorage.setItem('local_config', JSON.stringify(config));
                showResult('âœ… é…ç½®ä¿å­˜æˆåŠŸï¼', 'success');
                displayConfig();
                logTest('ä¿å­˜é…ç½®', 'æˆåŠŸ', config);
            } catch (error) {
                showResult('âŒ é…ç½®ä¿å­˜å¤±è´¥: ' + error.message, 'error');
                logTest('ä¿å­˜é…ç½®', 'å¤±è´¥', error.message);
            }
        }
        
        // åŠ è½½é…ç½®å‡½æ•°
        function loadConfig() {
            try {
                const config = localStorage.getItem('local_config');
                if (config) {
                    const parsedConfig = JSON.parse(config);
                    document.getElementById('local-url').value = parsedConfig.url || '';
                    document.getElementById('local-model').value = parsedConfig.model || '';
                    document.getElementById('local-timeout').value = parsedConfig.timeout || 30;
                    showResult('âœ… é…ç½®åŠ è½½æˆåŠŸï¼', 'success');
                    displayConfig();
                    logTest('åŠ è½½é…ç½®', 'æˆåŠŸ', parsedConfig);
                } else {
                    showResult('âš ï¸ æ²¡æœ‰æ‰¾åˆ°ä¿å­˜çš„é…ç½®', 'info');
                    logTest('åŠ è½½é…ç½®', 'æ— æ•°æ®', 'localStorageä¸­æ²¡æœ‰local_config');
                }
            } catch (error) {
                showResult('âŒ é…ç½®åŠ è½½å¤±è´¥: ' + error.message, 'error');
                logTest('åŠ è½½é…ç½®', 'å¤±è´¥', error.message);
            }
        }
        
        // æ¸…é™¤é…ç½®å‡½æ•°
        function clearConfig() {
            localStorage.removeItem('local_config');
            document.getElementById('local-url').value = '';
            document.getElementById('local-model').value = '';
            document.getElementById('local-timeout').value = '30';
            showResult('ğŸ—‘ï¸ é…ç½®å·²æ¸…é™¤', 'info');
            displayConfig();
            logTest('æ¸…é™¤é…ç½®', 'æˆåŠŸ', 'localStorageå·²æ¸…ç©º');
        }
        
        // æ˜¾ç¤ºé…ç½®
        function displayConfig() {
            const config = localStorage.getItem('local_config');
            if (config) {
                const parsedConfig = JSON.parse(config);
                document.getElementById('config-display').textContent = 
                    'é…ç½®æ•°æ®:\n' + JSON.stringify(parsedConfig, null, 2);
            } else {
                document.getElementById('config-display').textContent = 'æš‚æ— é…ç½®æ•°æ®';
            }
        }
        
        // æ˜¾ç¤ºç»“æœ
        function showResult(message, type) {
            const resultsDiv = document.getElementById('test-results');
            const resultElement = document.createElement('div');
            resultElement.className = type;
            resultElement.textContent = message;
            resultsDiv.appendChild(resultElement);
            
            // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
            resultElement.scrollIntoView({ behavior: 'smooth' });
            
            // 5ç§’åç§»é™¤ç»“æœ
            setTimeout(() => {
                if (resultElement.parentNode) {
                    resultElement.remove();
                }
            }, 5000);
        }
        
        // è®°å½•æµ‹è¯•æ—¥å¿—
        function logTest(action, result, data) {
            console.log(`[${new Date().toLocaleTimeString()}] ${action}: ${result}`, data);
        }
        
        // è¿è¡Œå®Œæ•´æµ‹è¯•
        function runFullTest() {
            showResult('ğŸ§ª å¼€å§‹è¿è¡Œå®Œæ•´æµ‹è¯•...', 'info');
            
            // æµ‹è¯•1: localStorageå¯ç”¨æ€§
            try {
                const testKey = 'test_' + Date.now();
                localStorage.setItem(testKey, 'test');
                localStorage.removeItem(testKey);
                showResult('âœ… localStorageå¯ç”¨æ€§æµ‹è¯•é€šè¿‡', 'success');
                logTest('localStorageå¯ç”¨æ€§', 'é€šè¿‡', 'æ­£å¸¸');
            } catch (error) {
                showResult('âŒ localStorageä¸å¯ç”¨: ' + error.message, 'error');
                logTest('localStorageå¯ç”¨æ€§', 'å¤±è´¥', error.message);
                return;
            }
            
            // æµ‹è¯•2: ä¿å­˜é…ç½®
            setTimeout(() => {
                saveConfig();
            }, 500);
            
            // æµ‹è¯•3: åŠ è½½é…ç½®
            setTimeout(() => {
                loadConfig();
            }, 1000);
            
            // æµ‹è¯•4: éªŒè¯æ•°æ®å®Œæ•´æ€§
            setTimeout(() => {
                const config = localStorage.getItem('local_config');
                if (config) {
                    const parsedConfig = JSON.parse(config);
                    if (parsedConfig.url && parsedConfig.model && parsedConfig.timeout) {
                        showResult('âœ… æ•°æ®å®Œæ•´æ€§éªŒè¯é€šè¿‡', 'success');
                        logTest('æ•°æ®å®Œæ•´æ€§', 'é€šè¿‡', parsedConfig);
                    } else {
                        showResult('âŒ æ•°æ®å®Œæ•´æ€§éªŒè¯å¤±è´¥', 'error');
                        logTest('æ•°æ®å®Œæ•´æ€§', 'å¤±è´¥', 'ç¼ºå°‘å¿…è¦å­—æ®µ');
                    }
                } else {
                    showResult('âŒ æ•°æ®å®Œæ•´æ€§éªŒè¯å¤±è´¥: æ²¡æœ‰æ‰¾åˆ°é…ç½®', 'error');
                    logTest('æ•°æ®å®Œæ•´æ€§', 'å¤±è´¥', 'æ²¡æœ‰æ‰¾åˆ°é…ç½®');
                }
            }, 1500);
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ˜¾ç¤ºå½“å‰é…ç½®
        window.onload = function() {
            displayConfig();
            showResult('ğŸ“„ é¡µé¢åŠ è½½å®Œæˆï¼Œå¯ä»¥å¼€å§‹æµ‹è¯•é…ç½®ä¿å­˜åŠŸèƒ½', 'info');
        };
        
        // ç›‘å¬è¡¨å•å˜åŒ–
        document.addEventListener('input', function(e) {
            if (e.target.id === 'local-url' || e.target.id === 'local-model' || e.target.id === 'local-timeout') {
                // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ å®æ—¶éªŒè¯é€»è¾‘
            }
        });
    </script>
</body>
</html>
